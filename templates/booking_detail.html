{% extends "base.html" %}
{% load static %}
{% block content %}
{% if not user.is_authenticated %}
<div class="container my-5">
    <div class="row justify-content-center align-items-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body text-center">
                    <div class="mb-4">
                        <p>You must be logged in to book tickets. Click <a href="{% url 'account_login' %}">here</a>to
                            login or
                            <a href="{% url 'account_signup' %}">here</a>to create an account.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <h1>{{ movie.title }}</h1>
    <img src="{{ movie.featured_image.url }}" alt="{{ movie.title }}">

    <h2>Showtime Details</h2>
    <p>{{ showtime }}</p>

    <img src="{% static 'images/cinema_screen_concept.png' %}"
        alt="Image of the 220 seat Huddersfield Picture House Theatre">

    <h2>Book a Seat</h2>
    <form method="POST" action="{% url 'booking_detail' pk=showtime.pk showtime_start_time=showtime.start_time %}" class="my-4">
        {% csrf_token %}
        <div class="form-group">
            {% for seat in available_seats %}
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="seats" id="id_seat_{{ seat }}" value="{{ seat }}">
                <label class="form-check-label" for="id_seat_{{ seat }}">Seat {{ seat }}</label>
            </div>
            {% endfor %}
            {% if form.errors %}
            <div class="text-danger">{{ form.errors.seats }}</div>
            {% endif %}
        </div>
        <button type="submit" class="btn btn-primary mt-3">Book Seat</button>
    </form>

    <h2>Booked Seats</h2>
    <ul>
        {% for seat in booked_seats %}
        <li>Seat {{ seat }}</li>
        {% empty %}
        <li>No seats booked yet.</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% endblock content %}